#include"iom16v.h"
#include <AVRdef.h>
//#include"led.h"
//#include"key.h"
#include"Nixie.h"
#include"adc.h"
//#include"uart.h"





void main(void)
{

    unsigned int voltage;
	unsigned int voule;
	//Key_Init();
	LED_Init();
     ADC_Init();
     Nixie_Init();
   
	
	while(1)
	{
	switch_open(1);
	//voltage=(voltage_AD())*1.377-10;
	//voltage=(voltage_AD())*2.084-672;
	//voltage=(voltage_AD())*6.094-5450;
	//ADC_show(voltage*10);
	//Nixie(1,voltage*10/1000);
	//Nixie(1,voltage/1000);
   // Nixie(2,voltage/100%10);
   // Nixie(3,voltage/10%10);
   // Nixie(4,voltage%10);
	if(voltage_AD()<1250)
	{
	if(voltage_AD()<350)
	{
     voltage=(voltage_AD())*1.362-4;
	 voule=voltage*2;
     Nixie(1,0);
     Nixie(2,voule/100%10);
     Nixie(3,voule/10%10);
     Nixie(4,voule%10);
	PORTB&=~BIT(2);   
	PORTB|=BIT(3);
	PORTB|=BIT(4);   //关LED代码   
	 
	}
     voltage=(voltage_AD())*2.468-1112;
	 voule=voltage*2;
     Nixie(1,voule/1000);
     Nixie(2,voule/100%10);
     Nixie(3,voule/10%10);
     Nixie(4,voule%10);
	PORTB|=BIT(2);   
	PORTB&=~BIT(3);
	PORTB|=BIT(4);   //关LED代码   
	}
	else
	{
	 voltage=(voltage_AD())*4-2700;
     voule=voltage*2;
     Nixie(1,voule/1000);
     Nixie(2,voule/100%10);
     Nixie(3,voule/10%10);
     Nixie(4,voule%10);
	PORTB|=BIT(2);   
	PORTB|=BIT(3);
	PORTB&=~BIT(4);   //关LED代码  
	}
	

	
	
   
   

	


	
	}
}

